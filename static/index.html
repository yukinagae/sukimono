<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>SUKIMONO</title>
	<link rel="stylesheet" type="text/css" href="css/sukimono.css">
</head>
<body>
	<div class="sidebar">
		<h1>SUKIMONO</h1>
		<form data-bind="submit: note().newNote">
			<ul>
				<li>Name</li>
				<li>
					<input data-bind="value: note().Name" style="width: 24rem;"/>
				</li>
				<li>Content</li>
				<li>
					<textarea data-bind="value: note().Content" style="width: 24rem; height: 8rem;"></textarea>
				</li>
			</ul>
			<button type="submit">New</button>
			<hr/>
		</form>
	</div>
	
	<div class="content" data-bind="foreach: list().notes">
		<div class="note">
			<h4 data-bind="text: $data.Name"></h4>
			<hr/>
			<p data-bind="text: $data.Content"></p>
			<span class="done">&#x2715; done</span>
		</div>
	</div>

	<script type="text/javascript" src="js/knockout-3.2.0.js"></script>
	<script type="text/javascript" src="js/jquery-2.1.1.min.js"></script>
	<script type="text/javascript">

		var NoteModels = function(notes) {
			this.notes = ko.observableArray(notes);
		};

		var NoteModel = function() {
			this.Name = ko.observable("");
			this.Content = ko.observable("");
			this.newNote = function() {
				$.post("/api/new", ko.toJSON(this), function(returnedData) {
					console.log(returnedData);
				});
			}.bind(this);
		};

		function list() {
			$.getJSON("/api/list").done(function(data){
				return data;
			});
		}

		var ViewModel = function() {
			var self = this;
			self.list = ko.observable(new NoteModels([]));
			self.note = ko.observable(new NoteModel());
		};

	ko.applyBindings(new ViewModel());

	</script>
</body>
</html>
